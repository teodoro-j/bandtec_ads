Arduino

int pinoSensor = 5; // Saída do sensor na A5
int valorLido = 0; // Variável auxiliar
float temperatura = 0; //Variável que armazenará a temperatura lida
int linha = 0; // Variável que se refere as linhas do excel

void setup() {//Função que será executada uma
Serial.begin(9600); // Inicia a comunicação serial a 9600 bauds
Serial.printIn("CLEARDATA"); // Reset comunicação serial
Serial.printIn("LABEL,Hora,Temperatura, linha"); //nomeia a coluna
}
void loop() {//Função que será executada continuamente
valorLindo = analogRead(pinoSensor);//Leitura analógica da porta A5
temperatura = (valorLido * 0.00488);// 5 volts/1023 = 0,0048 precisão do A/D
temperatura = temperatura * 100; // converte milivolts para celsius- cada 10mV=1 graus C
linha++;// incrementa linha para que a leitura pule linha
Serial.print("DATA", "TIME");
Serial.print("temperatura");
Serial.print (",")
Serial.print(linha);

If(linha > 100)// loop para linha// loop ara limita a quantidade de dados.
{
   linha =0;
   Serial.printIn("ROW,SET,2");//alimentação das linhas sempre com os fios alinhados
}
delay(100);//Tempo 5 seg para realizar outro leitura.
}




